<div class="page-header" style="margin-bottom: 16px">
  <button nz-button (click)="goBack()"><i nz-icon nzType="arrow-left"></i> Back</button>
</div>

<nz-card>
  <form nz-form [formGroup]="userForm" (ngSubmit)="submitForm()">
    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>First Name</nz-form-label>
      <nz-form-control [nzSpan]="14" nzErrorTip="Please input first name!">
        <input nz-input formControlName="first_name" placeholder="First Name" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>Last Name</nz-form-label>
      <nz-form-control [nzSpan]="14" nzErrorTip="Please input last name!">
        <input nz-input formControlName="last_name" placeholder="Last Name" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>Email</nz-form-label>
      <nz-form-control [nzSpan]="14" [nzErrorTip]="emailErrorTpl">
        <input nz-input formControlName="email" placeholder="Email" type="email" />
        <ng-template #emailErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')"> Please input email! </ng-container>
          <ng-container *ngIf="control.hasError('email')"> Please enter a valid email address! </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>Password</nz-form-label>
      <nz-form-control [nzSpan]="14" [nzErrorTip]="passwordErrorTpl">
        <nz-input-group [nzSuffix]="passwordSuffixIcon">
          <input nz-input formControlName="password" [type]="passwordVisible ? 'text' : 'password'" placeholder="Password" />
        </nz-input-group>
        <ng-template #passwordSuffixIcon>
          <i nz-icon [nzType]="passwordVisible ? 'eye' : 'eye-invisible'" (click)="togglePasswordVisibility()"></i>
        </ng-template>
        <ng-template #passwordErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">Please input password!</ng-container>
          <ng-container *ngIf="control.hasError('minlength')">Password must be at least 8 characters!</ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>Confirm Password</nz-form-label>
      <nz-form-control [nzSpan]="14" [nzErrorTip]="confirmErrorTpl">
        <nz-input-group [nzSuffix]="confirmPasswordSuffixIcon">
          <input nz-input formControlName="confirm_password" [type]="confirmPasswordVisible ? 'text' : 'password'" placeholder="Confirm Password" />
        </nz-input-group>
        <ng-template #confirmPasswordSuffixIcon>
          <i nz-icon [nzType]="confirmPasswordVisible ? 'eye' : 'eye-invisible'" (click)="toggleConfirmPasswordVisibility()"></i>
        </ng-template>
        <ng-template #confirmErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">Please confirm your password!</ng-container>
          <ng-container *ngIf="control.hasError('passwordMismatch')">Passwords do not match!</ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="6" nzRequired>Role</nz-form-label>
      <nz-form-control [nzSpan]="14" nzErrorTip="Please select a role!">
        <nz-select formControlName="role" nzPlaceHolder="Select a role">
          <nz-option nzValue="admin" nzLabel="Admin"></nz-option>
          <nz-option nzValue="teacher" nzLabel="Teacher"></nz-option>
          <nz-option nzValue="student" nzLabel="Student"></nz-option>
          <nz-option nzValue="parent" nzLabel="Parent"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSpan]="14">
        <button nz-button nzType="primary" [disabled]="!userForm.valid">Create User</button>
        <button nz-button nzType="default" (click)="cancelCreate()" style="margin-left: 8px">Cancel</button>
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-card>
